{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/basavaraju/Desktop/tantradotclone/tantradot/src/lib/mongodb.ts"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst MONGODB_URI = process.env.MONGODB_URI;\n\n// Global cache (prevents multiple connections in dev)\nlet cached = (global as any).mongoose;\n\nif (!cached) {\n  cached = (global as any).mongoose = {\n    conn: null,\n    promise: null,\n  };\n}\n\nexport async function connectDB() {\n  if (!MONGODB_URI) {\n    throw new Error(\n      \"Please define the MONGODB_URI environment variable in .env.local\"\n    );\n  }\n\n  if (cached.conn) {\n    return cached.conn;\n  }\n\n  if (!cached.promise) {\n    cached.promise = mongoose\n      .connect(MONGODB_URI)\n      .then((mongoose) => mongoose);\n  }\n\n  cached.conn = await cached.promise;\n  return cached.conn;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,sDAAsD;AACtD,IAAI,SAAS,yDAAgB,QAAQ;AAErC,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAgB,QAAQ,GAAG;QAClC,MAAM;QACN,SAAS;IACX;AACF;AAEO,eAAe;IACpB,IAAI,CAAC,aAAa;QAChB,MAAM,IAAI,MACR;IAEJ;IAEA,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,OAAO,GAAG,oHAAQ,CACtB,OAAO,CAAC,aACR,IAAI,CAAC,CAAC,WAAa;IACxB;IAEA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///home/basavaraju/Desktop/tantradotclone/tantradot/src/models/Admin.ts"],"sourcesContent":["import mongoose, { Schema, models } from \"mongoose\";\n\nconst AdminSchema = new Schema({\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n});\n\nexport default models.Admin || mongoose.model(\"Admin\", AdminSchema);\n "],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,IAAI,mHAAM,CAAC;IAC7B,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;AAC3C;uCAEe,mHAAM,CAAC,KAAK,IAAI,oHAAQ,CAAC,KAAK,CAAC,SAAS"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///home/basavaraju/Desktop/tantradotclone/tantradot/src/lib/jwt.ts"],"sourcesContent":["import jwt, { Secret, SignOptions } from \"jsonwebtoken\";\n\nconst SECRET: Secret = process.env.JWT_SECRET ?? \"dev_secret\";\nconst EXPIRY: SignOptions[\"expiresIn\"] =\n  (process.env.JWT_EXPIRY as SignOptions[\"expiresIn\"]) ?? \"24h\";\n\nexport interface TokenPayload {\n  id: string;\n  email: string;\n  iat?: number;\n  exp?: number;\n}\n\nexport function generateToken(id: string, email: string): string {\n  return jwt.sign(\n    { id, email },\n    SECRET,\n    { expiresIn: EXPIRY }\n  );\n}\n\nexport function verifyToken(token: string): TokenPayload | null {\n  try {\n    return jwt.verify(token, SECRET) as TokenPayload;\n  } catch {\n    return null;\n  }\n}\n\nexport function decodeToken(token: string): TokenPayload | null {\n  try {\n    return jwt.decode(token) as TokenPayload;\n  } catch {\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,SAAiB,QAAQ,GAAG,CAAC,UAAU,IAAI;AACjD,MAAM,SACJ,AAAC,QAAQ,GAAG,CAAC,UAAU,IAAiC;AASnD,SAAS,cAAc,EAAU,EAAE,KAAa;IACrD,OAAO,kJAAG,CAAC,IAAI,CACb;QAAE;QAAI;IAAM,GACZ,QACA;QAAE,WAAW;IAAO;AAExB;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///home/basavaraju/Desktop/tantradotclone/tantradot/src/app/api/admin/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { connectDB } from \"@/lib/mongodb\";\nimport Admin from \"@/models/Admin\";\nimport bcrypt from \"bcryptjs\";\nimport { generateToken } from \"@/lib/jwt\";\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json();\n    const { email, password } = body;\n\n    // Input validation\n    if (!email || !password) {\n      return NextResponse.json(\n        { error: \"Email and password are required\" },\n        { status: 400 }\n      );\n    }\n\n    if (typeof email !== \"string\" || typeof password !== \"string\") {\n      return NextResponse.json(\n        { error: \"Invalid input format\" },\n        { status: 400 }\n      );\n    }\n\n    await connectDB();\n\n    const admin = await Admin.findOne({ email });\n\n    if (!admin || !(await bcrypt.compare(password, admin.password))) {\n      return NextResponse.json(\n        { error: \"Invalid credentials\" },\n        { status: 401 }\n      );\n    }\n\n    // Generate JWT token\n    const token = generateToken(admin._id.toString(), admin.email);\n\n    const res = NextResponse.json({\n      message: \"Login successful\",\n      token,\n      admin: { id: admin._id, email: admin.email },\n    });\n\n    // Also set as HTTP-only cookie for browser compatibility\n    res.cookies.set(\"admin_token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"strict\",\n      path: \"/\",\n      maxAge: 60 * 60 * 24, // 24 hours\n    });\n\n    return res;\n  } catch (error) {\n    console.error(\"Admin login error:\", error);\n    return NextResponse.json(\n      {\n        error: \"Login failed\",\n        details: error instanceof Error ? error.message : \"Unknown error\",\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;QAE5B,mBAAmB;QACnB,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,OAAO,UAAU,YAAY,OAAO,aAAa,UAAU;YAC7D,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,IAAA,oIAAS;QAEf,MAAM,QAAQ,MAAM,mIAAK,CAAC,OAAO,CAAC;YAAE;QAAM;QAE1C,IAAI,CAAC,SAAS,CAAE,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,MAAM,QAAQ,GAAI;YAC/D,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,qBAAqB;QACrB,MAAM,QAAQ,IAAA,oIAAa,EAAC,MAAM,GAAG,CAAC,QAAQ,IAAI,MAAM,KAAK;QAE7D,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;YAC5B,SAAS;YACT;YACA,OAAO;gBAAE,IAAI,MAAM,GAAG;gBAAE,OAAO,MAAM,KAAK;YAAC;QAC7C;QAEA,yDAAyD;QACzD,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe,OAAO;YACpC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK;QACpB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}